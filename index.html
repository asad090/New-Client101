<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Program Batch & Enrollment Admin Panel</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* Custom scrollbar for a cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; /* slate-300 */
            border-radius: 4px;
        }
        .modal {
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal.hidden {
            opacity: 0;
            visibility: hidden;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans min-h-screen">
    <div id="app" class="flex flex-col md:flex-row h-full">

        <!-- Sidebar/Navigation -->
        <aside class="w-full md:w-64 bg-white shadow-xl p-4 md:h-screen md:sticky top-0">
            <h1 class="text-2xl font-bold text-indigo-700 mb-6">LMS Admin</h1>
            <nav>
                <ul>
                    <li class="mb-2">
                        <a href="#batches" class="flex items-center p-3 text-sm font-medium text-white bg-indigo-600 rounded-lg shadow-md">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2m-6 0h6"></path></svg>
                            Batch & Enrollment
                        </a>
                    </li>
                    <li class="mb-2">
                        <button onclick="openModal('emailTemplateModal')" class="w-full text-left flex items-center p-3 text-sm font-medium text-gray-600 hover:text-indigo-700 hover:bg-indigo-50 rounded-lg transition duration-150">
                            <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                            Edit Welcome Email
                        </button>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content Area -->
        <main class="flex-1 p-4 md:p-8 overflow-y-auto">
            <header class="mb-8">
                <h2 class="text-3xl font-semibold text-gray-800">Batch Management & Enrollment</h2>
                <p class="text-gray-500">Overview of current program batches and student management.</p>
            </header>

            <!-- Batches Section -->
            <section id="batches" class="bg-white p-6 rounded-xl shadow-lg mb-8">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-medium text-gray-800">Active Batches</h3>
                    <button onclick="openModal('createBatchModal')" class="flex items-center px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700 transition duration-150 shadow-md">
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                        Create New Batch
                    </button>
                </div>

                <!-- Batches Table Mockup -->
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Batch Name</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Program</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Teacher</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Students</th>
                                <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <!-- Dummy Data Rows -->
                            <tr data-batch-id="B101">
                                <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900">WebDev Fall 2025-A</td>
                                <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">Full-Stack Bootcamp</td>
                                <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">Mr. Alex Johnson</td>
                                <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">45/50</td>
                                <td class="px-4 py-4 whitespace-nowrap text-sm">
                                    <button onclick="selectBatch('WebDev Fall 2025-A', 45)" class="text-indigo-600 hover:text-indigo-900 font-medium mr-3">Enrollments</button>
                                    <button onclick="simulateEmailSend('WebDev Fall 2025-A')" class="text-green-600 hover:text-green-800 font-medium">Send Welcome Email</button>
                                </td>
                            </tr>
                            <tr data-batch-id="B102">
                                <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900">DataSci Spring 2026-B</td>
                                <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">Data Science Masterclass</td>
                                <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">Dr. Sarah Lee</td>
                                <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-500">22/25</td>
                                <td class="px-4 py-4 whitespace-nowrap text-sm">
                                    <button onclick="selectBatch('DataSci Spring 2026-B', 22)" class="text-indigo-600 hover:text-indigo-900 font-medium mr-3">Enrollments</button>
                                    <button onclick="simulateEmailSend('DataSci Spring 2026-B')" class="text-green-600 hover:text-green-800 font-medium">Send Welcome Email</button>
                                </td>
                            </tr>
                            <!-- End Dummy Data -->
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- Image tag added to visualize the concept for the dev team -->
            [Image of a modern administrative dashboard design]

            <!-- Enrollment Cards Section (Initially hidden) -->
            <section id="enrollmentSection" class="bg-white p-6 rounded-xl shadow-lg" style="display: none;">
                <h3 class="text-xl font-medium text-gray-800 mb-6">Student Enrollment Cards for: <span id="selectedBatchName" class="text-indigo-600"></span></h3>
                <div class="flex justify-between items-center mb-4">
                    <p class="text-sm text-gray-500">Total Students: <span id="totalStudentsCount">0</span></p>
                    <div class="space-x-2">
                         <!-- NEW: Add Student Button -->
                        <button onclick="openModal('addStudentModal')" class="flex items-center px-3 py-1 bg-green-600 text-white text-xs font-medium rounded-lg hover:bg-green-700 transition duration-150">
                            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-3 2h-4a2 2 0 00-2 2v4M10 9a2 2 0 11-4 0 2 2 0 014 0zm6 3a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                            Add Student
                        </button>
                        <!-- Existing Export List Button -->
                        <button class="px-3 py-1 bg-gray-200 text-gray-700 text-xs rounded-lg hover:bg-gray-300 transition duration-150">Export List</button>
                    </div>
                </div>
                
                <!-- Student Cards Mockup Grid -->
                <div id="studentCardsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Cards will be injected here by JavaScript -->
                    <div class="bg-indigo-50 p-4 rounded-lg shadow-sm border-l-4 border-indigo-500">
                        <p class="text-sm font-semibold text-gray-800">John Doe</p>
                        <p class="text-xs text-gray-600 truncate">john.doe@example.com</p>
                        <span class="inline-block mt-2 px-2 py-0.5 text-xs font-medium bg-green-200 text-green-800 rounded-full">Enrolled</span>
                        <div class="mt-3 flex space-x-2">
                            <!-- UPDATED: Added parameters to viewStudentProfile for interactivity -->
                            <button onclick="viewStudentProfile(1, 'John Doe', 'john.doe@example.com', 'WebDev Fall 2025-A', 'Mr. Alex Johnson')" class="text-xs text-indigo-600 hover:text-indigo-800">View Profile</button>
                            <button class="text-xs text-red-600 hover:text-red-800" onclick="showToast('Student Unenrolled (Simulated)')">Unenroll</button>
                        </div>
                    </div>
                    <div class="bg-indigo-50 p-4 rounded-lg shadow-sm border-l-4 border-indigo-500">
                        <p class="text-sm font-semibold text-gray-800">Jane Smith</p>
                        <p class="text-xs text-gray-600 truncate">jane.smith@example.com</p>
                        <span class="inline-block mt-2 px-2 py-0.5 text-xs font-medium bg-green-200 text-green-800 rounded-full">Enrolled</span>
                        <div class="mt-3 flex space-x-2">
                             <!-- UPDATED: Added parameters to viewStudentProfile for interactivity -->
                            <button onclick="viewStudentProfile(2, 'Jane Smith', 'jane.smith@example.com', 'DataSci Spring 2026-B', 'Dr. Sarah Lee')" class="text-xs text-indigo-600 hover:text-indigo-800">View Profile</button>
                            <button class="text-xs text-red-600 hover:text-red-800" onclick="showToast('Student Unenrolled (Simulated)')">Unenroll</button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>


    <!-- ================================== MODALS ================================== -->

    <!-- Modal 1: Create New Batch -->
    <div id="createBatchModal" class="modal hidden fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg p-6 transform transition-all scale-100">
            <h3 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">Create New Batch (Ongoing Program)</h3>

            <form onsubmit="handleCreateBatch(event)">
                <!-- Program Selection -->
                <div class="mb-4">
                    <label for="program" class="block text-sm font-medium text-gray-700">Program</label>
                    <select id="program" name="program" required class="mt-1 block w-full border border-gray-300 rounded-lg shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                        <option value="">Select a Program</option>
                        <option value="Full-Stack Bootcamp">Full-Stack Bootcamp</option>
                        <option value="Data Science Masterclass">Data Science Masterclass</option>
                        <option value="Cloud Engineering">Cloud Engineering</option>
                    </select>
                </div>

                <!-- Batch Name -->
                <div class="mb-4">
                    <label for="batchName" class="block text-sm font-medium text-gray-700">Batch Name</label>
                    <input type="text" id="batchName" name="batchName" placeholder="e.g., WebDev Fall 2025-C" required class="mt-1 block w-full border border-gray-300 rounded-lg shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                
                <!-- NEW: Program Duration (Weeks) -->
                <div class="mb-4">
                    <label for="programDuration" class="block text-sm font-medium text-gray-700">Program Duration (Weeks)</label>
                    <input type="number" id="programDuration" name="programDuration" placeholder="e.g., 12" required class="mt-1 block w-full border border-gray-300 rounded-lg shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                </div>

                <!-- Batch Shift -->
                <div class="mb-4">
                    <label for="batchShift" class="block text-sm font-medium text-gray-700">Batch Shift</label>
                    <select id="batchShift" name="batchShift" required class="mt-1 block w-full border border-gray-300 rounded-lg shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                        <option value="">Select Shift</option>
                        <option value="Morning">Morning</option>
                        <option value="Afternoon">Afternoon</option>
                        <option value="Evening">Evening</option>
                    </select>
                </div>
                
                <!-- Start Date (Batch Start Date) -->
                <div class="mb-4">
                    <label for="startDate" class="block text-sm font-medium text-gray-700">Batch Start Date (Administrative)</label>
                    <input type="date" id="startDate" name="startDate" required class="mt-1 block w-full border border-gray-300 rounded-lg shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                </div>

                <!-- Start Time and End Time fields -->
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="startTime" class="block text-sm font-medium text-gray-700">Start Time</label>
                        <input type="time" id="startTime" name="startTime" required class="mt-1 block w-full border border-gray-300 rounded-lg shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                    <div>
                        <label for="endTime" class="block text-sm font-medium text-gray-700">End Time</label>
                        <input type="time" id="endTime" name="endTime" required class="mt-1 block w-full border border-gray-300 rounded-lg shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                </div>
                
                <!-- Teacher Assignment -->
                <div class="mb-6">
                    <label for="teacher" class="block text-sm font-medium text-gray-700">Assign Lead Teacher</label>
                    <select id="teacher" name="teacher" required class="mt-1 block w-full border border-gray-300 rounded-lg shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                        <option value="">Select a Teacher</option>
                        <option value="Mr. Alex Johnson">Mr. Alex Johnson</option>
                        <option value="Dr. Sarah Lee">Dr. Sarah Lee</option>
                        <option value="Ms. Chloe Davies">Ms. Chloe Davies</option>
                    </select>
                </div>

                <div class="flex justify-end space-x-3">
                    <button type="button" onclick="closeModal('createBatchModal')" class="px-4 py-2 bg-gray-200 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-300 transition duration-150">Cancel</button>
                    <button type="submit" class="px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700 transition duration-150 shadow-md">Create Batch</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal 2: Edit Welcome Email Template -->
    <div id="emailTemplateModal" class="modal hidden fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl p-6 transform transition-all scale-100">
            <h3 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">Edit Student Welcome Email Template (LMS)</h3>

            <form onsubmit="handleEmailSave(event)">
                <div class="mb-4">
                    <label for="emailSubject" class="block text-sm font-medium text-gray-700">Subject Line</label>
                    <input type="text" id="emailSubject" value="Welcome to the Program - Get Started Now!" class="mt-1 block w-full border border-gray-300 rounded-lg shadow-sm p-2">
                </div>
                <div class="mb-4">
                    <label for="emailBody" class="block text-sm font-medium text-gray-700">Email Body (Supports Merge Tags)</label>
                    <textarea id="emailBody" rows="10" class="mt-1 block w-full border border-gray-300 rounded-lg shadow-sm p-3 font-mono text-xs" placeholder="Use merge tags like {{STUDENT_NAME}}, {{PROGRAM_NAME}}, {{BATCH_NAME}}, and {{LMS_LINK}} for personalization.">
Dear {{STUDENT_NAME}},

A huge welcome to the {{PROGRAM_NAME}} - Batch {{BATCH_NAME}}!

Your journey with us officially kicks off on **{{STUDENT_START_DATE}}**. Based on the program's **{{PROGRAM_DURATION}} weeks**, your anticipated graduation date is **{{STUDENT_END_DATE}}**.

Your instructor for this batch is {{TEACHER_NAME}}.

To get started right away and access your course materials, please log into the Learning Management System (LMS) here:
{{LMS_LINK}}

If you have any questions before your start date, please don't hesitate to reach out.

We look forward to seeing you succeed!

Best regards,

The {{PROGRAM_NAME}} Team
                    </textarea>
                </div>

                <div class="flex justify-between items-center text-sm text-gray-500 mb-6">
                    <p class="bg-yellow-100 text-yellow-800 p-2 rounded-lg">
                        <span class="font-bold">Note:</span> Changes here affect all future welcome emails. Merge tags (e.g., {{STUDENT_START_DATE}}) will be calculated per student.
                    </p>
                    <p class="font-medium">Last Edited: 2025-12-01 by Admin User</p>
                </div>

                <div class="flex justify-end space-x-3">
                    <button type="button" onclick="closeModal('emailTemplateModal')" class="px-4 py-2 bg-gray-200 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-300 transition duration-150">Close</button>
                    <button type="submit" class="px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700 transition duration-150 shadow-md">Save Template</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal 3: Add New Student -->
    <div id="addStudentModal" class="modal hidden fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg p-6 transform transition-all scale-100">
            <h3 class="text-xl font-semibold text-gray-800 mb-4 border-b pb-2">Add New Student to Batch <span id="modalBatchName" class="text-indigo-600"></span></h3>

            <form onsubmit="handleAddStudent(event)">
                <!-- Student Name -->
                <div class="mb-4">
                    <label for="studentName" class="block text-sm font-medium text-gray-700">Student Full Name</label>
                    <input type="text" id="studentName" name="studentName" placeholder="e.g., Alice Brown" required class="mt-1 block w-full border border-gray-300 rounded-lg shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                </div>

                <!-- Student Email -->
                <div class="mb-4">
                    <label for="studentEmail" class="block text-sm font-medium text-gray-700">Student Email</label>
                    <input type="email" id="studentEmail" name="studentEmail" placeholder="e.g., alice.brown@example.com" required class="mt-1 block w-full border border-gray-300 rounded-lg shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                </div>

                <!-- Initial Status -->
                <div class="mb-6">
                    <label for="enrollmentStatus" class="block text-sm font-medium text-gray-700">Initial Enrollment Status</label>
                    <select id="enrollmentStatus" name="enrollmentStatus" required class="mt-1 block w-full border border-gray-300 rounded-lg shadow-sm p-2 focus:ring-indigo-500 focus:border-indigo-500">
                        <option value="Enrolled">Enrolled</option>
                        <option value="Waitlisted">Waitlisted</option>
                        <option value="Pending Payment">Pending Payment</option>
                    </select>
                </div>

                <div class="flex justify-between items-center mt-6">
                    <button type="button" onclick="closeModal('addStudentModal')" class="px-4 py-2 bg-gray-200 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-300 transition duration-150">Cancel</button>
                    <button type="submit" class="px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700 transition duration-150 shadow-md">Add Student</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal 4: Student Profile Detail -->
    <div id="studentProfileModal" class="modal hidden fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-xl p-6 transform transition-all scale-100">
            <div class="flex justify-between items-start mb-4 border-b pb-2">
                <h3 class="text-2xl font-semibold text-gray-800">Student Profile: <span id="profileName" class="text-indigo-600"></span></h3>
                <span id="profileStatus" class="px-3 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Enrolled</span>
            </div>

            <div class="space-y-4 text-gray-700">
                <!-- Contact Info -->
                <div class="border-b pb-3">
                    <p class="text-sm font-medium text-gray-500 uppercase mb-1">Contact Details</p>
                    <p><span class="font-semibold">Email:</span> <span id="profileEmail"></span></p>
                    <p><span class="font-semibold">Phone:</span> <span id="profilePhone">Not Provided</span></p>
                </div>
                
                <!-- Program Info (UPDATED FOR ONGOING ENROLLMENT MODEL) -->
                <div class="border-b pb-3">
                    <p class="text-sm font-medium text-gray-500 uppercase mb-1">Enrollment Details</p>
                    <p><span class="font-semibold">Batch:</span> <span id="profileBatch"></span></p>
                    <p><span class="font-semibold">Program:</span> <span id="profileProgram">Full-Stack Bootcamp</span></p>
                    <p><span class="font-semibold">Program Duration:</span> <span id="profileDuration"></span></p>
                    <p><span class="font-semibold">Teacher:</span> <span id="profileTeacher"></span></p>
                    <p class="mt-2 text-indigo-600 font-bold border-t pt-2">Personalized Timeline:</p>
                    <p><span class="font-semibold">Student Start Date:</span> <span id="studentStartDate"></span></p>
                    <p><span class="font-semibold">Anticipated End Date:</span> <span id="studentEndDate"></span></p>
                    <p class="mt-2 text-gray-500 italic"><span class="font-semibold">Batch Start Date:</span> <span id="profileBatchStartDate"></span></p>
                </div>

                <!-- LMS Activity (Mock) -->
                <div>
                    <p class="text-sm font-medium text-gray-500 uppercase mb-1">LMS Activity (Last 7 Days)</p>
                    <ul class="list-disc list-inside text-sm bg-gray-50 p-3 rounded-lg">
                        <li>Last Login: 2 hours ago</li>
                        <li>Modules Completed: 3/12</li>
                        <li>Total Quiz Score: 85%</li>
                    </ul>
                </div>

                <!-- Communication History Section -->
                <div>
                    <p class="text-sm font-medium text-gray-500 uppercase mb-1">Welcome Email History</p>
                    <div id="emailHistoryContainer" class="space-y-2 text-sm">
                        <!-- History items will be injected here by JS -->
                    </div>
                </div>
            </div>

            <div class="mt-6 pt-4 border-t flex justify-end space-x-3">
                <button onclick="showToast('LMS Login Link Sent (Simulated)')" class="px-4 py-2 bg-yellow-500 text-white text-sm font-medium rounded-lg hover:bg-yellow-600 transition duration-150">Resend Welcome Email</button>
                <button onclick="showToast('Student Profile Edited (Simulated)')" class="px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg hover:bg-indigo-700 transition duration-150">Edit Profile Data</button>
                <button type="button" onclick="closeModal('studentProfileModal')" class="px-4 py-2 bg-gray-200 text-gray-700 text-sm font-medium rounded-lg hover:bg-gray-300 transition duration-150">Close</button>
            </div>
        </div>
    </div>


    <!-- Toast Notification Area -->
    <div id="toastContainer" class="fixed bottom-4 right-4 space-y-3 z-[100]">
        <!-- Toasts will be injected here -->
    </div>

    <script>
        // =================================== MODAL & UI FUNCTIONS ===================================
        function openModal(id) {
            document.getElementById(id).classList.remove('hidden');
        }

        function closeModal(id) {
            document.getElementById(id).classList.add('hidden');
        }

        function showToast(message, type = 'success') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            
            let bgColor = 'bg-green-500';
            let icon = '<svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';

            if (type === 'error') {
                bgColor = 'bg-red-500';
                icon = '<svg class="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
            }

            toast.className = `${bgColor} text-white p-4 rounded-xl shadow-lg flex items-center transform transition-transform duration-300 translate-x-full`;
            toast.innerHTML = `${icon}<span class="text-sm font-medium">${message}</span>`;
            
            container.appendChild(toast);

            // Animate in
            setTimeout(() => {
                toast.style.transform = 'translateX(0)';
            }, 50);

            // Animate out and remove
            setTimeout(() => {
                toast.style.transform = 'translateX(calc(100% + 1rem))';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Close modals when clicking outside
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', (e) => {
                if (e.target.id === modal.id) {
                    closeModal(modal.id);
                }
            });
        });

        // =================================== DATA & ACTION HANDLERS ===================================

        // Simulated function for creating a batch
        function handleCreateBatch(event) {
            event.preventDefault();
            const form = event.target;
            const batchName = form.batchName.value;
            const program = form.program.value;
            const programDuration = form.programDuration.value; // Get program duration
            const batchShift = form.batchShift.value; // Get batch shift
            const startDate = form.startDate.value;
            const startTime = form.startTime.value; // Get required start time
            const endTime = form.endTime.value;     // Get required end time
            const teacher = form.teacher.value;

            // Log data for dev team reference
            console.log('--- NEW BATCH CREATION SIMULATION (ONGOING PROGRAM MODEL) ---');
            console.log('Batch Name:', batchName);
            console.log('Program:', program);
            console.log('Program Duration (Weeks):', programDuration);
            console.log('Batch Shift:', batchShift);
            console.log('Batch Start Date (Administrative):', startDate);
            console.log('Start Time:', startTime);
            console.log('End Time:', endTime);
            console.log('Teacher:', teacher);
            console.log('---');

            // Simulate API call success
            closeModal('createBatchModal');
            showToast(`Batch "${batchName}" (${programDuration} weeks) created.`, 'success');
        }

        // Simulated function for saving email template
        function handleEmailSave(event) {
            event.preventDefault();
            const subject = document.getElementById('emailSubject').value;
            const body = document.getElementById('emailBody').value;

            // Log data for dev team reference
            console.log('--- EMAIL TEMPLATE SAVE SIMULATION ---');
            console.log('New Subject:', subject);
            console.log('New Body (Truncated):', body.substring(0, 100) + '...');
            console.log('---');
            
            // Simulate API call success
            closeModal('emailTemplateModal');
            showToast('Welcome Email Template successfully updated in LMS.', 'success');
        }

        // Simulated function for sending welcome email
        function simulateEmailSend(batchName) {
            showToast(`Welcome email queued for all students in ${batchName}.`, 'success');
            // Log for dev team
            console.log(`Email Send Action: Triggered welcome email for batch: ${batchName}`);
        }

        // Simulated function for adding a student
        function handleAddStudent(event) {
            event.preventDefault();
            const form = event.target;
            const studentName = form.studentName.value;
            const studentEmail = form.studentEmail.value;
            const status = form.enrollmentStatus.value;
            const batchName = document.getElementById('selectedBatchName').textContent;

            // Log data for dev team reference
            console.log('--- NEW STUDENT ENROLLMENT SIMULATION ---');
            console.log('Student Name:', studentName);
            console.log('Student Email:', studentEmail);
            console.log('Status:', status);
            console.log('Batch:', batchName);
            console.log('---');

            // Simulate API call success
            closeModal('addStudentModal');
            form.reset(); // Clear the form
            showToast(`${studentName} successfully added to ${batchName} with status: ${status}.`, 'success');
        }

        // Function to display student profile details
        function viewStudentProfile(studentId, name, email, batch, teacher) {
            // In a real application, you would fetch all these details based on studentId
            // This is mock data for the interactive prototype:
            const mockData = {
                1: { 
                    program: 'Full-Stack Bootcamp', 
                    programDurationWeeks: 12, 
                    batchStartDate: '2025-10-15', 
                    studentStartDate: '2025-11-01', // Personalized start date
                    studentEndDate: '2026-01-24',  // Calculated end date (12 weeks later)
                    status: 'Enrolled', 
                    phone: '555-0101',
                    emailHistory: [
                        { date: '2025-10-10 14:30', status: 'Sent (Initial Enrollment)' },
                        { date: '2025-10-14 09:15', status: 'Resent (Manual)' }
                    ]
                },
                2: { 
                    program: 'Data Science Masterclass', 
                    programDurationWeeks: 8, 
                    batchStartDate: '2026-04-01', 
                    studentStartDate: '2026-04-15', // Personalized start date
                    studentEndDate: '2026-06-10', // Calculated end date (8 weeks later)
                    status: 'Enrolled', 
                    phone: '555-0202',
                    emailHistory: [
                         { date: '2026-03-28 10:00', status: 'Sent (Initial Enrollment)' }
                    ]
                },
            };

            const data = mockData[studentId] || {};

            // Populate the modal fields
            document.getElementById('profileName').textContent = name;
            document.getElementById('profileEmail').textContent = email;
            document.getElementById('profileBatch').textContent = batch;
            document.getElementById('profileTeacher').textContent = teacher;
            
            document.getElementById('profileProgram').textContent = data.program || 'N/A';
            document.getElementById('profileDuration').textContent = `${data.programDurationWeeks || 'N/A'} Weeks`;
            document.getElementById('profileBatchStartDate').textContent = data.batchStartDate || 'N/A'; 
            document.getElementById('studentStartDate').textContent = data.studentStartDate || 'N/A'; 
            document.getElementById('studentEndDate').textContent = data.studentEndDate || 'N/A'; 
            
            // Update status badge dynamically
            const statusBadge = document.getElementById('profileStatus');
            statusBadge.textContent = data.status || 'N/A';
            statusBadge.className = `px-3 py-1 text-xs font-semibold rounded-full ${data.status === 'Enrolled' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}`;

            // Populate Email History
            const emailHistoryContainer = document.getElementById('emailHistoryContainer');
            emailHistoryContainer.innerHTML = ''; // Clear previous history

            if (data.emailHistory && data.emailHistory.length > 0) {
                data.emailHistory.forEach(item => {
                    const historyItem = document.createElement('p');
                    historyItem.className = 'text-gray-600';
                    historyItem.innerHTML = `<span class="font-mono text-xs bg-gray-100 p-1 rounded">${item.date}</span>: ${item.status}`;
                    emailHistoryContainer.appendChild(historyItem);
                });
            } else {
                emailHistoryContainer.innerHTML = '<p class="text-gray-500 italic text-sm">No welcome email history found.</p>';
            }

            // Open the modal
            openModal('studentProfileModal');
            
            // Log for dev team reference
            console.log(`View Profile Action: Opened profile for Student ID ${studentId} (${name})`);
        }


        // Function to switch to the Enrollment Cards view
        function selectBatch(batchName, studentCount) {
            document.getElementById('selectedBatchName').textContent = batchName;
            document.getElementById('modalBatchName').textContent = batchName; // Update modal header context
            document.getElementById('totalStudentsCount').textContent = studentCount;
            document.getElementById('enrollmentSection').style.display = 'block';

            // Scroll to the new section
            document.getElementById('enrollmentSection').scrollIntoView({ behavior: 'smooth' });

            // In a real app, you would fetch and render student data here.
        }

        window.onload = function() {
            // Optional: Show the first section if not already visible
            document.getElementById('batches').scrollIntoView();
        }
    </script>
</body>
</html>
